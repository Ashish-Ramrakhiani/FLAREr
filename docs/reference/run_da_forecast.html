<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Run ensemble data assimilation and/or produce forecasts — run_da_forecast • FLAREr</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Run ensemble data assimilation and/or produce forecasts — run_da_forecast"><meta property="og:description" content="Run ensemble data assimilation and/or produce forecasts"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">FLAREr</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">2.2.21</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/flare-config-vignette.html">FLAREr configurations</a>
    </li>
    <li>
      <a href="../articles/flare-example-vignette.html">FLAREr example</a>
    </li>
    <li>
      <a href="../articles/flare-workflow-vignette.html">Example Workflow</a>
    </li>
  </ul></li>
      </ul><ul class="nav navbar-nav navbar-right"></ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Run ensemble data assimilation and/or produce forecasts</h1>
    
    <div class="hidden name"><code>run_da_forecast.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Run ensemble data assimilation and/or produce forecasts</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">run_da_forecast</span><span class="op">(</span></span>
<span>  <span class="va">states_init</span>,</span>
<span>  pars_init <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="va">aux_states_init</span>,</span>
<span>  <span class="va">obs</span>,</span>
<span>  <span class="va">obs_sd</span>,</span>
<span>  <span class="va">model_sd</span>,</span>
<span>  <span class="va">working_directory</span>,</span>
<span>  <span class="va">met_file_names</span>,</span>
<span>  inflow_file_names <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  outflow_file_names <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="va">config</span>,</span>
<span>  pars_config <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="va">states_config</span>,</span>
<span>  <span class="va">obs_config</span>,</span>
<span>  management <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  da_method <span class="op">=</span> <span class="st">"enkf"</span>,</span>
<span>  par_fit_method <span class="op">=</span> <span class="st">"inflate"</span>,</span>
<span>  debug <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  log_wq <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  obs_secchi <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  obs_depth <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>states_init</dt>
<dd><p>array of the initial states.  Required dimensions are <code>[states, depths, ensemble]</code></p></dd>


<dt>pars_init</dt>
<dd><p>array of the initial states.  Required dimensions are <code>[pars, depths, ensemble]</code>.  (Default = NULL)</p></dd>


<dt>aux_states_init</dt>
<dd><p>list of initial conditions for auxillary states.  These are states in the GLM that
are require for restarting the model but are not included in data assimilation.  These are states that are not associated
with a value in <code>model_sd</code>.</p></dd>


<dt>obs</dt>
<dd><p>array; array of the observations. Required dimensions are <code>[nobs, time, depth]</code></p></dd>


<dt>obs_sd</dt>
<dd><p>vector; vector of standard deviation for observation</p></dd>


<dt>model_sd</dt>
<dd><p>vector vector of standard deviations describing the model error for each state</p></dd>


<dt>working_directory</dt>
<dd><p>string; full path to directory where model executes</p></dd>


<dt>met_file_names</dt>
<dd><p>vector; vector of full path meteorology file names</p></dd>


<dt>inflow_file_names</dt>
<dd><p>vector or matrix;; vector of inflow file names</p></dd>


<dt>outflow_file_names</dt>
<dd><p>vector or matrix; vector of outflow file names</p></dd>


<dt>config</dt>
<dd><p>list; list of configurations</p></dd>


<dt>pars_config</dt>
<dd><p>list; list of parameter configurations  (Default = NULL)</p></dd>


<dt>states_config</dt>
<dd><p>list; list of state configurations</p></dd>


<dt>obs_config</dt>
<dd><p>list; list of observation configurations</p></dd>


<dt>management</dt>
<dd><p>list; list of management inputs and configuration  (Default = NULL)</p></dd>


<dt>da_method</dt>
<dd><p>string; data assimilation method (enkf or pf; Default = enkf)</p></dd>


<dt>par_fit_method</dt>
<dd><p>string; method for adding noise to parameters during calibration</p></dd>


<dt>debug</dt>
<dd><p>boolean; add extra diagnostics for debugging (Default = FALSE)</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p>a list is passed to <code><a href="write_forecast_netcdf.html">write_forecast_netcdf()</a></code> to write the
netcdf output and <code>create_flare_eml()</code> to generate the EML metadata</p>
    </div>
    <div id="details">
    <h2>Details</h2>
    <p>Uses the ensemble data assimilation to predict water quality for a lake
or reservoir.  The function requires the initial conditions (<code>states_init</code>) for each
state and ensemble member using an array with the following dimension order:
states, depth, ensembles member.  If you are fitting parameters, it also requires
initial conditions for each parameter and ensemble member using an array (<code>par_init</code>) with the
following dimension order: parameters, ensemble member.  The arrays for states_init
and pars_init can be created using the <code><a href="generate_initial_conditions.html">generate_initial_conditions()</a></code> function, if
starting from initial conditions in the  <code>states_config</code> data frame or from observations
in first time column of the <code>obs</code> array.</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span><span class="va">da_forecast_output</span> <span class="op">&lt;-</span> <span class="fu">FLAREr</span><span class="fu">::</span><span class="fu">run_da_forecast</span><span class="op">(</span>states_init <span class="op">=</span> <span class="va">init</span><span class="op">$</span><span class="va">states</span>, pars_init <span class="op">=</span> <span class="va">init</span><span class="op">$</span><span class="va">pars</span>, aux_states_init <span class="op">=</span> <span class="va">init</span><span class="op">$</span><span class="va">aux_states_init</span>, obs <span class="op">=</span> <span class="va">obs</span>, obs_sd <span class="op">=</span> <span class="va">obs_config</span><span class="op">$</span><span class="va">obs_sd</span>, model_sd <span class="op">=</span> <span class="va">model_sd</span>, working_directory <span class="op">=</span> <span class="va">config</span><span class="op">$</span><span class="va">file_path</span><span class="op">$</span><span class="va">execute_directory</span>, met_file_names <span class="op">=</span> <span class="va">met_file_names</span>, inflow_file_names <span class="op">=</span> <span class="va">inflow_file_names</span>, outflow_file_names <span class="op">=</span> <span class="va">outflow_file_names</span>, config <span class="op">=</span> <span class="va">config</span>, pars_config <span class="op">=</span> <span class="va">pars_config</span>, states_config <span class="op">=</span> <span class="va">states_config</span>, obs_config <span class="op">=</span> <span class="va">obs_config</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by R. Quinn Thomas.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer></div>

  


  

  </body></html>

